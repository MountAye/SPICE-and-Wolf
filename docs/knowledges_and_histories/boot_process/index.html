<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Arch Linux 的启动流程 | SPICE and Wolf （暂定）</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/SPICE-and-Wolf/assets/css/0.styles.bd531b56.css" as="style"><link rel="preload" href="/SPICE-and-Wolf/assets/js/app.826313ca.js" as="script"><link rel="preload" href="/SPICE-and-Wolf/assets/js/2.c04902be.js" as="script"><link rel="preload" href="/SPICE-and-Wolf/assets/js/33.3c741b2d.js" as="script"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/10.d48b972b.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/11.88f2d6db.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/12.9056f6ac.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/13.206b0943.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/14.cc9292b5.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/15.bdcd8b23.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/16.d535fb37.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/17.ac7cd794.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/18.1a067ef6.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/19.2ac84ad9.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/20.0e215edb.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/21.d432fb19.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/22.e354fdab.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/23.00a91c1f.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/24.74046139.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/25.73b34c24.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/26.19b85396.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/27.66c3808e.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/28.5118da9d.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/29.9cb9fccc.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/3.99dcaab8.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/30.024386c0.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/31.b9376f48.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/32.b8f72bf6.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/34.dd5b80a1.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/35.645e8797.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/36.138e067c.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/37.5274650e.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/38.8cb4b4af.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/39.ccb2ed44.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/4.6c35dd08.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/40.ceddf721.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/41.d26b5970.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/42.e2695be2.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/43.61a2b3de.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/44.c394a62a.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/45.e5b36a6d.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/46.04559bcb.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/5.02584255.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/6.9102d1a5.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/7.9cb9b958.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/8.029bb2b3.js"><link rel="prefetch" href="/SPICE-and-Wolf/assets/js/9.95ad7f5e.js">
    <link rel="stylesheet" href="/SPICE-and-Wolf/assets/css/0.styles.bd531b56.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/SPICE-and-Wolf/" class="home-link router-link-active"><!----> <span class="site-name">SPICE and Wolf （暂定）</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/SPICE-and-Wolf/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/SPICE-and-Wolf/knowledges_and_histories/boot_process/.html#" class="nav-link">
  Placeholder
</a></div> <a href="https://github.com/project-wolves/SPICE-and-Wolf" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/SPICE-and-Wolf/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/SPICE-and-Wolf/knowledges_and_histories/boot_process/.html#" class="nav-link">
  Placeholder
</a></div> <a href="https://github.com/project-wolves/SPICE-and-Wolf" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/SPICE-and-Wolf/" class="sidebar-heading clickable router-link-active open"><span>首页</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/SPICE-and-Wolf/plans.html" class="sidebar-link">规划中目录</a></li><li><a href="/SPICE-and-Wolf/drafts/" class="sidebar-link">施工中页面</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>总次</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/SPICE-and-Wolf/knowledges_and_histories/" aria-current="page" class="sidebar-link">科普和史话</a></li><li><a href="/SPICE-and-Wolf/experiences_from_writers/" class="sidebar-link">编者经验谈</a></li><li><a href="/SPICE-and-Wolf/install_arch_linux/" class="sidebar-link">安装 Arch Linux</a></li><li><a href="/SPICE-and-Wolf/softwares/" class="sidebar-link">使用各种软件</a></li><li><a href="/SPICE-and-Wolf/basic_usage/" class="sidebar-link">基本使用</a></li><li><a href="/SPICE-and-Wolf/troubleshooting/" class="sidebar-link">故障排除</a></li><li><a href="/SPICE-and-Wolf/virtualbox_install_and_usage/" class="sidebar-link">附录：安装和设置 VirtualBox</a></li><li><a href="/SPICE-and-Wolf/further_reading/" class="sidebar-link">前方的路</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="arch-linux-的启动流程"><a href="#arch-linux-的启动流程" class="header-anchor">#</a> Arch Linux 的启动流程</h1> <h2 id="linux-内核启动前"><a href="#linux-内核启动前" class="header-anchor">#</a> Linux 内核启动前</h2> <h3 id="bios"><a href="#bios" class="header-anchor">#</a> BIOS</h3> <ul><li>开机时加电自检。（这一步有时会简称为 POST）</li> <li>BIOS 执行在「BIOS 硬盘顺序」中的第一块硬盘上的前 440 字节代码，即主引导记录。</li> <li>主引导记录执行它之后的第二阶段代码，一般就是启动引导器。</li></ul> <h3 id="uefi"><a href="#uefi" class="header-anchor">#</a> UEFI</h3> <ul><li>开机时加电自检。</li> <li>UEFI 固件被加载，并由它初始化启动要用的硬件。</li> <li>固件读取其引导管理器和 efivars 以确定从何处（比如，从哪个硬盘及分区）加载哪个 UEFI 应用。</li> <li>固件按照引导管理器中的启动项目，加载UEFI 应用。（通常是启动加载器）</li></ul> <h3 id="启动加载器"><a href="#启动加载器" class="header-anchor">#</a> 启动加载器</h3> <p>Bootloader 俗称“启动加载器”，是用来引导系统启动，加载内核之类的特殊软件。</p> <p>GNU/Linux 下常用的启动引导器大概有这么几种：</p> <ul><li><p>GRUB ，即 GRand Unified Bootloader。大家现在经常用到的其实是它的下一代（GRUB 2），是个功能丰富的启动加载器</p> <p>（或者说是个 OS 也无妨）。</p></li> <li><p>Systemd-boot ，前称 gummiboot。一个配置简单的启动加载器（虽然只支持 UEFI）</p></li> <li><p>rEFInd，外观精美，自动配置简单。</p></li></ul> <h3 id="initramfs"><a href="#initramfs" class="header-anchor">#</a> initramfs</h3> <p>内核被加载后，它就会解压 mkinitcpio ， 又名 initial RAM filesystem, 后者会伪装成一个已初始化的根文件系统。内核接着会执行 /init 作为第一条进程。这就是所谓的「用户空间」啦~</p> <blockquote><p>初始内存盘本质上是一个很小的运行环境（早期用户空间），用于加载一些核心模块，并在 init 接管启动过程之前做必要的准备。有了这个环境，才能支持加密根文件系统、RAID上的根文件系统等高级功能。mkinicpio 支持自定义的钩子扩展、运行时自动检测以及其他功能。</p> <p><a href="https://wiki.archlinux.org/index.php/Mkinitcpio_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/index.php/Mkinitcpio_(简体中文)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>initramfs 会加载启动时所需要的各种模块，并挂载好根文件系统。</p> <p>在「早期用户空间」的最终环节里，真正的根文件系统被挂载好后，就会替换掉原来的伪根文件系统。接着 /sbin/init 被执行，同样也替换掉原来的 /init 进程。</p> <h3 id="getty-或者显示管理器"><a href="#getty-或者显示管理器" class="header-anchor">#</a> Getty 或者显示管理器</h3> <p>init 为每一个 虚拟终端 调用 getty，前者一般有六个，每个虚拟终端都会初始化 tty 并请求输入用户名和密码。当在某虚拟终端输入用户名和密码后，其 getty 会通过 /etc/passwd 检查是否正确，如果正确，就接着调用 login。</p> <p>如果有使用显示管理器的话，显示管理器, 会代替原来的 getty 登录命令行提示符展示登录画面。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/project-wolves/SPICE-and-Wolf/edit/master/knowledges_and_histories/boot_process/README.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最近更改:</span> <span class="time">5/29/2020, 9:17:34 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/SPICE-and-Wolf/assets/js/app.826313ca.js" defer></script><script src="/SPICE-and-Wolf/assets/js/2.c04902be.js" defer></script><script src="/SPICE-and-Wolf/assets/js/33.3c741b2d.js" defer></script>
  </body>
</html>
